# ๐ ุฏููู ุฅุนุฏุงุฏ Google OAuth ูููุดุฑูุน

## ๐ ุงููุดููุฉ ุงูุญุงููุฉ
```
Error: invalid_grant - Token has been expired or revoked
```

## โ ุงูุญู ุงููุงูู (ุฎุทูุฉ ุจุฎุทูุฉ)

### ุงููุฑุญูุฉ 1๏ธโฃ: ุงูุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช Google Cloud Console

#### 1. ุงูุชุญ Google Cloud Console:
๐ https://console.cloud.google.com/

#### 2. ุงุฎุชุฑ ุงููุดุฑูุน ุฃู ุฃูุดุฆ ูุงุญุฏ ุฌุฏูุฏ

#### 3. ูุนูู Google Drive API:
- ุงุฐูุจ ุฅูู: **APIs & Services** > **Library**
- ุงุจุญุซ ุนู: **Google Drive API**
- ุงุถุบุท: **Enable**

#### 4. ุฃูุดุฆ OAuth 2.0 Credentials:
```
๐ APIs & Services > Credentials > Create Credentials > OAuth client ID

ุงุฎุชุฑ:
- Application type: Desktop app
- Name: TikTok Recorder Bot

ุณูุนุทูู:
โ Client ID
โ Client Secret
```

#### 5. ๐จ **ููู ุฌุฏุงู:** ูุดุฑ ุงูุชุทุจูู (Publishing)
```
๐ APIs & Services > OAuth consent screen

โ๏ธ ุฅุฐุง ูุงู Status = "Testing"
   โ ุงุถุบุท "PUBLISH APP" ูุชุญูููู ุฅูู "In Production"
   โ ูุฅูุง ุณุชูุชูู ุตูุงุญูุฉ ุงูู Token ูู 7 ุฃูุงู!

ุฃู ุฃุถู ุจุฑูุฏู ุงูุฅููุชุฑููู ุฅูู "Test users" ุฅุฐุง ุฃุฑุฏุช ุฅุจูุงุฆู Testing
```

---

### ุงููุฑุญูุฉ 2๏ธโฃ: ุชูููุฏ Refresh Token ุฌุฏูุฏ

#### 1. ุชุฃูุฏ ูู ูุฌูุฏ ุงูุจูุงูุงุช ูู ููู `.env`:
```bash
GOOGLE_CLIENT_ID=your_client_id
GOOGLE_CLIENT_SECRET=your_client_secret
```

#### 2. ุดุบูู ุณูุฑูุจุช ุงูุชูููุฏ:
```bash
node generate-refresh-token.js
```

#### 3. ุงุชุจุน ุงูุฎุทูุงุช:
```
โ ุงูุชุญ ุงูุฑุงุจุท ูู ุงููุชุตูุญ
โ ุณุฌู ุฏุฎูู ุจุญุณุงุจ Google
โ ุงุณูุญ ุจุงูุตูุงุญูุงุช
โ ุงูุณุฎ ุงูููุฏ
โ ุงูุตูู ูู ุงูุชุฑููุงู
โ ุงุญูุธ ุงูู GOOGLE_REFRESH_TOKEN ุงูุฌุฏูุฏ
```

#### 4. ุญุฏูุซ ููู `.env`:
```bash
GOOGLE_REFRESH_TOKEN=1//0xxxxxxxxxxxxxxxxxxxxxxxxx
```

---

### ุงููุฑุญูุฉ 3๏ธโฃ: ุงูุชุฃูุฏ ูู ุตูุงุญูุงุช Drive

#### ุชุฃูุฏ ูู ุฅุถุงูุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฅูู ุงููุฌูุฏ:
```
1. ุงูุชุญ Google Drive
2. ุงุฐูุจ ุฅูู ุงููุฌูุฏ ุงููุณุชูุฏู
3. ุงุถุบุท "Share" / "ูุดุงุฑูุฉ"
4. ุฃุถู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุญุณุงุจ ุงูุฐู ุณุฌูุช ุจู
5. ุงููุญู ุตูุงุญูุฉ "Editor" ุฃู "Owner"
```

---

## ๐ก๏ธ ููู ุชุชุฌูุจ ุงูุชูุงุก ุงูู Token ูุณุชูุจูุงูุ

### โ ุงูุญููู:

#### 1. **ูุดุฑ ุงูุชุทุจูู (Production)**
```
ูุถุน "In Production" = Token ูุง ููุชูู ุฃุจุฏุงู
ูุถุน "Testing" = Token ููุชูู ุจุนุฏ 7 ุฃูุงู
```

#### 2. **ุงุณุชุฎุฏุงู Token ุจุงูุชุธุงู**
```javascript
// ุงูุจูุช ูุณุชุฎุฏู Token ุชููุงุฆูุงู ุนูุฏ:
- ูู ุนูููุฉ ุฑูุน ููุฏูู
- Google ูุฌุฏุฏ Access Token ุชููุงุฆูุงู

โ๏ธ ุฅุฐุง ูู ุชุณุชุฎุฏู Token ููุฏุฉ 6 ุฃุดูุฑ โ ุณูููุบู ุชููุงุฆูุงู
```

#### 3. **ูุฑุงูุจุฉ ุฃุฎุทุงุก Google Drive**
```javascript
// ูู drive.service.js ููุฌูุฏ try-catch
// ูุทุจุน ุงูุฃุฎุทุงุก ูู ุงูู console
```

#### 4. **ูุณุฎ ุงุญุชูุงุทู ููู Tokens**
```bash
# ุงุญูุธ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู .env
cp .env .env.backup
```

---

## ๐ ุฅุนุงุฏุฉ ุชูููุฏ Token ุนูุฏ ุงูุญุงุฌุฉ

### ูุชู ุชุญุชุงุฌ ูุฅุนุงุฏุฉ ุงูุชูููุฏุ
- โ ุนูุฏ ุธููุฑ ุฎุทุฃ: `invalid_grant`
- ๐ ุจุนุฏ ุชุบููุฑ ูููุฉ ูุฑูุฑ Google
- ๐๏ธ ุจุนุฏ ุฅูุบุงุก ุงูุตูุงุญูุงุช ูุฏููุงู
- โฐ ุจุนุฏ 6 ุฃุดูุฑ ูู ุนุฏู ุงูุงุณุชุฎุฏุงู

### ุงูุญู ุงูุณุฑูุน:
```bash
# 1. ุดุบู ุงูุณูุฑูุจุช
node generate-refresh-token.js

# 2. ุญุฏูุซ .env
vim .env  # ุฃู ุฃู ูุญุฑุฑ ูุตูุต

# 3. ุฃุนุฏ ุชุดุบูู ุงูุจูุช
npm start
```

---

## ๐ ูุตุงุฏุฑ ูููุฏุฉ

- ๐ Google OAuth Documentation:
  https://developers.google.com/identity/protocols/oauth2

- ๐ง Google Cloud Console:
  https://console.cloud.google.com/

- ๐ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช:
  https://myaccount.google.com/permissions

- ๐ Google Drive API:
  https://developers.google.com/drive/api/guides/about-sdk

---

## โก ููุฎุต ุณุฑูุน

```bash
# ุฅุฐุง ุธูุฑ ุฎุทุฃ invalid_grant:

1๏ธโฃ ุงูุชุญ Google Cloud Console
2๏ธโฃ ุชุฃูุฏ ูู ูุดุฑ ุงูุชุทุจูู (PUBLISH APP)
3๏ธโฃ ุดุบู: node generate-refresh-token.js
4๏ธโฃ ุงูุณุฎ ุงูู GOOGLE_REFRESH_TOKEN ุงูุฌุฏูุฏ
5๏ธโฃ ุญุฏูุซ ููู .env
6๏ธโฃ ุฃุนุฏ ุชุดุบูู ุงูุจูุช: npm start
7๏ธโฃ ุฌุฑุจ ุฑูุน ููุฏูู ููุชุฃูุฏ
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

| ููุน Token | ูุฏุฉ ุงูุตูุงุญูุฉ | ูุชุฌุฏุฏ ุชููุงุฆูุงูุ |
|-----------|--------------|-----------------|
| **Access Token** | 1 ุณุงุนุฉ | โ ูุนู (ุจุงุณุชุฎุฏุงู Refresh Token) |
| **Refresh Token** | ุฏุงุฆู* | โ ูุง (ูุญุชุงุฌ ุฅุนุงุฏุฉ ุชูููุฏ ูุฏููุงู) |

\* *ุฏุงุฆู ุฅุฐุง ูุงู ุงูุชุทุจูู "In Production" ูููุณุชุฎุฏู ุจุงูุชุธุงู*

---

**ุขุฎุฑ ุชุญุฏูุซ:** 1 ุฏูุณูุจุฑ 2025
